[[rules]]
id = "SL-HID-002"
name = "HTML Comment Hiding"
severity = "warning"
pattern = '<!--[\s\S]*?(?:ignore|hide|secret|bypass|override|system|inject)[\s\S]*?-->'
applies_to = ["markdown"]
message_template = "HTML comment may hide instructions: {match}"
multiline = true

[[rules]]
id = "SL-HID-003"
name = "Base64 Encoded Content"
severity = "warning"
pattern = '[A-Za-z0-9+/]{40,}={0,2}'
applies_to = []
message_template = "Possible base64-encoded content detected: {match}"

[[rules]]
id = "SL-HID-004"
name = "Hex Encoded Content"
severity = "warning"
pattern = '(?:\\x[0-9a-fA-F]{2}){8,}'
applies_to = []
message_template = "Hex-encoded content detected: {match}"

[[rules]]
id = "SL-HID-005"
name = "URL Encoded Content"
severity = "warning"
pattern = '(?:%[0-9a-fA-F]{2}){8,}'
applies_to = []
message_template = "URL-encoded content detected: {match}"

[[rules]]
id = "SL-HID-006"
name = "Invisible Unicode in Code Block"
severity = "error"
pattern = '```[\s\S]*?[\x{200B}-\x{200F}\x{202A}-\x{202E}\x{2060}-\x{2064}][\s\S]*?```'
applies_to = ["markdown"]
message_template = "Code block contains invisible Unicode characters: {match}"
multiline = true

[[rules]]
id = "SL-HID-007"
name = "Data URI Embedding"
severity = "warning"
pattern = 'data:[a-zA-Z]+/[a-zA-Z0-9.+-]+;base64,[A-Za-z0-9+/=]{20,}'
applies_to = []
message_template = "Embedded data URI detected: {match}"

[[rules]]
id = "SL-HID-008"
name = "Steganographic Reference"
severity = "info"
pattern = '(?i)(?:stegan|hidden\s+data|embed(?:ded)?\s+(?:payload|message|data))'
applies_to = []
message_template = "Reference to data hiding technique: {match}"

[[rules]]
id = "SL-HID-009"
name = "Obfuscated Variable Names"
severity = "warning"
pattern = '(?:_0x[a-fA-F0-9]{4,}|\\x[0-9a-fA-F]{2}(?:\\x[0-9a-fA-F]{2})+|[a-zA-Z]\d[a-zA-Z]\d[a-zA-Z]\d{2,})'
applies_to = ["script"]
message_template = "Obfuscated variable name detected: {match}"
